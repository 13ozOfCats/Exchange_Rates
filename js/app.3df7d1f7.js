(function(t){function e(e){for(var n,r,i=e[0],c=e[1],o=e[2],d=0,p=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&p.push(s[r][0]),s[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(p.length)p.shift()();return l.push.apply(l,o||[]),a()}function a(){for(var t,e=0;e<l.length;e++){for(var a=l[e],n=!0,i=1;i<a.length;i++){var c=a[i];0!==s[c]&&(n=!1)}n&&(l.splice(e--,1),t=r(r.s=a[0]))}return t}var n={},s={app:0},l=[];function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=n,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/Exchange_Rates/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var o=0;o<i.length;o++)e(i[o]);var u=c;l.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"2f68":function(t,e,a){"use strict";a("e411")},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("ExchangeRates")],1)},l=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"exchange-rates"},[t.currencies?[a("ExchangeMenu",{staticClass:"exchange-rates__block",attrs:{currencies:t.currencies,wallet:t.wallet},on:{update:t.setWallet}}),a("RatesTable",{staticClass:"exchange-rates__block",attrs:{date:t.date,currencies:t.currencies}}),a("AccountBalance",{staticClass:"exchange-rates__block",attrs:{wallet:t.wallet}})]:t._e()],2)},i=[],c=a("bc3a"),o=a.n(c),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"account-balance"},[a("div",{staticClass:"title"},[t._v(" Баланс ")]),a("table",[a("tbody",t._l(t.wallet,(function(e,n){return a("tr",{key:n},[a("td",[t._v(" "+t._s(n)+" ")]),a("td",[t._v(" "+t._s(e.toFixed(2))+" ")])])})),0)])])},d=[],p={name:"AccountBalance",props:{wallet:{type:Object,required:!0}}},h=p,_=a("2877"),b=Object(_["a"])(h,u,d,!1,null,null,null),f=b.exports,v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rates-table"},[a("div",{staticClass:"title"},[t._v("Курс валют на "+t._s(t.date))]),a("table",{staticClass:"rates-table__course-table"},[t._m(0),a("tbody",t._l(t.currencies,(function(e,n){return a("tr",{key:n},[a("td",[t._v(" "+t._s(n)+" ")]),a("td",[t._v(" "+t._s(e.Nominal)+" ")]),a("td",{style:{color:t.getColor(e.Value,e.Previous)}},[t._v(" "+t._s(e.Value)+" ("+t._s(t.getDifference(e.Value,e.Previous))+") ")])])})),0)])])},m=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("td",[t._v(" Код ")]),a("td",[t._v(" Единиц ")]),a("td",[t._v(" Курс ")])])])}],y={name:"RatesTable",props:{date:{type:String,required:!0},currencies:{type:Object,required:!0}},methods:{getDifference(t,e){const a=t-e;return(a>0?"+":"")+a.toFixed(2)},getColor(t,e){const a=(t-e).toFixed(2);let n="#000000";return a>0?n="#00b956":a<0&&(n="#f62434"),n}}},w=y,g=(a("9976"),Object(_["a"])(w,v,m,!1,null,"7c065400",null)),x=g.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.currencies?a("div",[a("RatesSelect",{attrs:{rates:t.currencies},on:{newRate:t.newRate}}),a("div",{staticClass:"controls__block"},[a("div",{staticClass:"subtitle"},[t._v(" Доступно: ")]),a("div",{staticClass:"controls__shrink"},[a("span",{staticClass:"title"},[t._v(" "+t._s(t.available.toFixed(2))+" "+t._s(t.rate))])])]),a("div",{staticClass:"controls__block"},[a("div",{staticClass:"subtitle"},[t._v(" Хочу: ")]),a("div",{staticClass:"controls__checkboxes"},[a("label",{staticClass:"controls__label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.buyMode,expression:"buyMode"}],staticClass:"controls__checkbox",attrs:{type:"radio",name:"control"},domProps:{value:!0,checked:t._q(t.buyMode,!0)},on:{change:function(e){t.buyMode=!0}}}),a("span",[t._v("Купить")])]),a("label",{staticClass:"controls__label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.buyMode,expression:"buyMode"}],staticClass:"controls__checkbox",attrs:{type:"radio",name:"control"},domProps:{value:!1,checked:t._q(t.buyMode,!1)},on:{change:function(e){t.buyMode=!1}}}),a("span",[t._v("Продать")])])]),a("div",{staticClass:"controls__shrink"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.inputValue,expression:"inputValue",modifiers:{number:!0}}],staticClass:"controls__input",attrs:{type:"number",placeholder:"0.00",min:t.nominal,max:t.available,step:t.nominal},domProps:{value:t.inputValue},on:{input:function(e){e.target.composing||(t.inputValue=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])])]),a("div",{staticClass:"controls__block"},[a("div",{staticClass:"subtitle"},[t._v(" "+t._s(t.sumText)+" ")]),a("div",{staticClass:"controls__shrink"},[a("span",{staticClass:"title"},[t._v(t._s(t.debit.toFixed(2))+" ₽")])])]),t.rate?a("div",{staticClass:"controls__block"},[a("button",{staticClass:"controls__btn",on:{click:t.transaction}},[t._v(" "+t._s(t.btnText)+" ")])]):t._e()],1):t._e()},j=[],k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rates-select"},[a("div",{staticClass:"subtitle"},[t._v(" Валюта: ")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.current,expression:"current"}],staticClass:"rates-select__select",attrs:{name:"ratesSelect"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.current=e.target.multiple?a:a[0]}}},t._l(t.rates,(function(e,n){return a("option",{key:n,domProps:{value:n}},[t._v(" "+t._s(e.Name)+" ("+t._s(n)+") ")])})),0)])},O=[],M={props:{rates:{type:Object,required:!0}},data(){return{current:null}},watch:{current:function(t){this.$emit("newRate",t)}}},R=M,V=(a("2f68"),Object(_["a"])(R,k,O,!1,null,"733cdb84",null)),E=V.exports,$={name:"ExchangeMenu",components:{RatesSelect:E},props:{currencies:{type:Object,required:!0},wallet:{type:Object,required:!0}},data(){return{buyMode:!0,inputValue:null,rate:null}},computed:{nominal(){return null!==this.currencies&&null!==this.rate?this.currencies[this.rate].Nominal:1},debit(){let t=0;if(null!==this.currencies&&this.rate){const e=this.currencies[this.rate];t=e.Value*this.inputValue/e.Nominal}return t},btnText(){return this.buyMode?"Купить":"Продать"},sumText(){return this.buyMode?"Заплачу:":"Получу:"},available(){let t=0;if(null!==this.currencies&&null!==this.rate){const e=this.currencies[this.rate],a=Math.floor(this.wallet["RUR"]/e.Value)*e.Nominal;this.buyMode?t=a:this.wallet[this.rate]&&(t=this.wallet[this.rate])}return t}},methods:{newRate(t){this.rate=t},transaction(){if(this.inputValue){let t,e;const a=this.wallet[this.rate]?this.wallet[this.rate]:0,n=this.wallet["RUR"];if(this.buyMode){if(!(n>=this.debit))return alert("Не досточно денег на счету"),!1;if(this.inputValue%this.nominal!==0)return alert("Эта валюта продается по "+this.nominal+" единиц. Введите число, кратное "+this.nominal),!1;t=a+this.inputValue,e=n-this.debit}else{if(!(a>=this.inputValue))return alert("Валюты на счету меньше чем вы хотите продать"),!1;if(this.inputValue%this.nominal!==0)return alert("Эта валюта продается по "+this.nominal+" единиц. Введите число, кратное "+this.nominal),!1;t=a-this.inputValue,e=n+this.debit}this.$emit("update",{name:this.rate,value:t}),this.$emit("update",{name:"RUR",value:e})}else alert("Введите количество")}}},P=$,S=(a("8081"),Object(_["a"])(P,C,j,!1,null,"d1dad394",null)),T=S.exports,N={name:"ExchangeRates",components:{ExchangeMenu:T,RatesTable:x,AccountBalance:f},data(){return{currencies:null,wallet:{},date:null,loading:!0}},async mounted(){await o.a.get("https://www.cbr-xml-daily.ru/daily_json.js").then(t=>{if(t.data){const e=t.data,a=e.Date.split("T")[0].split("-");this.date=a[2]+"."+a[1]+"."+a[0],this.currencies=e.Valute}}).finally(()=>this.loading=!1),this.getWallet()},methods:{getWallet(){const t=localStorage.getItem("wallet");t?t.split("|").forEach(t=>{if(t){const e=t.split(":");this.$set(this.wallet,e[0],Number(e[1]))}}):this.setWallet({name:"RUR",value:1e4})},setWallet(t){const e=t.value;t.value?this.wallet[t.name]?this.wallet[t.name]=e:this.$set(this.wallet,t.name,e):this.$delete(this.wallet,t.name);let a="";for(const n in this.wallet)a+=n+":"+this.wallet[n]+"|";localStorage.setItem("wallet",a)}}},q=N,A=(a("cea3"),Object(_["a"])(q,r,i,!1,null,"6acc4b3c",null)),F=A.exports,U={name:"App",components:{ExchangeRates:F}},W=U,B=(a("5c0b"),Object(_["a"])(W,s,l,!1,null,null,null)),D=B.exports,I=a("2f62");n["a"].use(I["a"]);var J=new I["a"].Store({state:{},mutations:{},actions:{},modules:{}});n["a"].config.productionTip=!1,new n["a"]({store:J,render:t=>t(D)}).$mount("#app")},"5c0b":function(t,e,a){"use strict";a("9c0c")},8081:function(t,e,a){"use strict";a("d68a")},9976:function(t,e,a){"use strict";a("bd99")},"9c0c":function(t,e,a){},bd99:function(t,e,a){},cea3:function(t,e,a){"use strict";a("d124")},d124:function(t,e,a){},d68a:function(t,e,a){},e411:function(t,e,a){}});
//# sourceMappingURL=app.3df7d1f7.js.map